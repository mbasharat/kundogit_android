/*
 * Copyright (C) 2011 Lothar Wa√ümann <LW@KARO-electronics.de>
 * based on: board/freesclae/mx28_evk.c (C) 2010 Freescale Semiconductor, Inc.
 *
 * See file CREDITS for list of people who contributed to this
 * project.
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License as
 * published by the Free Software Foundation; either version 2 of
 * the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston,
 * MA 02111-1307 USA
 */

#include <common.h>
#include <config.h>
#include <asm/io.h>
#include <asm/gpio.h>
#include <asm/arch/iomux-mx6.h>
#include <asm/arch/imx-regs.h>
#include <asm/arch/sys_proto.h>

#define	MUX_CONFIG_LED	MX6_PAD_CTL_DSE_80ohm
#define	MUX_CONFIG_LCD	(MX6_PAD_CTL_SPEED_HIGH | MX6_PAD_CTL_SRE_FAST | \
				MX6_PAD_CTL_DSE_80ohm)
#define	MUX_CONFIG_TSC	(MX6_PAD_CTL_SRE_FAST | MX6_PAD_CTL_DSE_80ohm | \
				MX6_PAD_CTL_PUS_47K_UP)
#define	MUX_CONFIG_GPMI	MX6_PAD_CTL_DSE_80ohm
#define	MUX_CONFIG_EMI	MX6Q_HIGH_DRV
#define MUX_CONFIG_GPIO MX6_PAD_CTL_PUS_47K_UP

static iomux_v3_cfg_t tx6q_stk5_pads[] = {
	/* LED */
	MX6Q_PAD_EIM_A18__GPIO_2_20,

	/* framebuffer */
	MX6Q_PAD_DISP0_DAT0__IPU1_DISP0_DAT_0,
	MX6Q_PAD_DISP0_DAT1__IPU1_DISP0_DAT_1,
	MX6Q_PAD_DISP0_DAT2__IPU1_DISP0_DAT_2,
	MX6Q_PAD_DISP0_DAT3__IPU1_DISP0_DAT_3,
	MX6Q_PAD_DISP0_DAT4__IPU1_DISP0_DAT_4,
	MX6Q_PAD_DISP0_DAT5__IPU1_DISP0_DAT_5,
	MX6Q_PAD_DISP0_DAT6__IPU1_DISP0_DAT_6,
	MX6Q_PAD_DISP0_DAT7__IPU1_DISP0_DAT_7,
	MX6Q_PAD_DISP0_DAT8__IPU1_DISP0_DAT_8,
	MX6Q_PAD_DISP0_DAT9__IPU1_DISP0_DAT_9,
	MX6Q_PAD_DISP0_DAT10__IPU1_DISP0_DAT_10,
	MX6Q_PAD_DISP0_DAT11__IPU1_DISP0_DAT_11,
	MX6Q_PAD_DISP0_DAT12__IPU1_DISP0_DAT_12,
	MX6Q_PAD_DISP0_DAT13__IPU1_DISP0_DAT_13,
	MX6Q_PAD_DISP0_DAT14__IPU1_DISP0_DAT_14,
	MX6Q_PAD_DISP0_DAT15__IPU1_DISP0_DAT_15,
	MX6Q_PAD_DISP0_DAT16__IPU1_DISP0_DAT_16,
	MX6Q_PAD_DISP0_DAT17__IPU1_DISP0_DAT_17,
	MX6Q_PAD_DISP0_DAT18__IPU1_DISP0_DAT_18,
	MX6Q_PAD_DISP0_DAT19__IPU1_DISP0_DAT_19,
	MX6Q_PAD_DISP0_DAT20__IPU1_DISP0_DAT_20,
	MX6Q_PAD_DISP0_DAT21__IPU1_DISP0_DAT_21,
	MX6Q_PAD_DISP0_DAT22__IPU1_DISP0_DAT_22,
	MX6Q_PAD_DISP0_DAT23__IPU1_DISP0_DAT_23,
	MX6Q_PAD_DI0_PIN3__IPU1_DI0_PIN3, /* LCD VSYNC */
	MX6Q_PAD_DI0_PIN2__IPU1_DI0_PIN2, /* LCD HSYNC */
	MX6Q_PAD_DI0_DISP_CLK__IPU1_DI0_DISP_CLK, /* LCD DOTCLK */
	MX6Q_PAD_DI0_PIN15__IPU1_DI0_PIN15, /* LCD OE/ACD */

	/* UART1 pads */
	MX6Q_PAD_SD3_DAT7__UART1_TXD,
	MX6Q_PAD_SD3_DAT6__UART1_RXD,
	MX6Q_PAD_SD3_DAT1__UART1_RTS,
	MX6Q_PAD_SD3_DAT0__UART1_CTS,

	/* EMI */
	MX6_PAD_EMI_D00__EMI_DATA0,
	MX6_PAD_EMI_D01__EMI_DATA1,
	MX6_PAD_EMI_D02__EMI_DATA2,
	MX6_PAD_EMI_D03__EMI_DATA3,
	MX6_PAD_EMI_D04__EMI_DATA4,
	MX6_PAD_EMI_D05__EMI_DATA5,
	MX6_PAD_EMI_D06__EMI_DATA6,
	MX6_PAD_EMI_D07__EMI_DATA7,
	MX6_PAD_EMI_D08__EMI_DATA8,
	MX6_PAD_EMI_D09__EMI_DATA9,
	MX6_PAD_EMI_D10__EMI_DATA10,
	MX6_PAD_EMI_D11__EMI_DATA11,
	MX6_PAD_EMI_D12__EMI_DATA12,
	MX6_PAD_EMI_D13__EMI_DATA13,
	MX6_PAD_EMI_D14__EMI_DATA14,
	MX6_PAD_EMI_D15__EMI_DATA15,
	MX6_PAD_EMI_ODT0__EMI_ODT0,
	MX6_PAD_EMI_DQM0__EMI_DQM0,
	MX6_PAD_EMI_ODT1__EMI_ODT1,
	MX6_PAD_EMI_DQM1__EMI_DQM1,
	MX6_PAD_EMI_DDR_OPEN_FB__EMI_DDR_OPEN_FEEDBACK,
	MX6_PAD_EMI_CLK__EMI_CLK,
	MX6_PAD_EMI_DQS0__EMI_DQS0,
	MX6_PAD_EMI_DQS1__EMI_DQS1,
	MX6_PAD_EMI_DDR_OPEN__EMI_DDR_OPEN,

	MX6_PAD_EMI_A00__EMI_ADDR0,
	MX6_PAD_EMI_A01__EMI_ADDR1,
	MX6_PAD_EMI_A02__EMI_ADDR2,
	MX6_PAD_EMI_A03__EMI_ADDR3,
	MX6_PAD_EMI_A04__EMI_ADDR4,
	MX6_PAD_EMI_A05__EMI_ADDR5,
	MX6_PAD_EMI_A06__EMI_ADDR6,
	MX6_PAD_EMI_A07__EMI_ADDR7,
	MX6_PAD_EMI_A08__EMI_ADDR8,
	MX6_PAD_EMI_A09__EMI_ADDR9,
	MX6_PAD_EMI_A10__EMI_ADDR10,
	MX6_PAD_EMI_A11__EMI_ADDR11,
	MX6_PAD_EMI_A12__EMI_ADDR12,
	MX6_PAD_EMI_A13__EMI_ADDR13,
	MX6_PAD_EMI_A14__EMI_ADDR14,
	MX6_PAD_EMI_BA0__EMI_BA0,
	MX6_PAD_EMI_BA1__EMI_BA1,
	MX6_PAD_EMI_BA2__EMI_BA2,
	MX6_PAD_EMI_CASN__EMI_CASN,
	MX6_PAD_EMI_RASN__EMI_RASN,
	MX6_PAD_EMI_WEN__EMI_WEN,
	MX6_PAD_EMI_CE0N__EMI_CE0N,
	MX6_PAD_EMI_CE1N__EMI_CE1N,
	MX6_PAD_EMI_CKE__EMI_CKE,

	/* FEC pads */
	MX6_PAD_PWM4__GPIO_3_29,
	MX6_PAD_ENET0_RX_CLK__GPIO_4_13,
	MX6_PAD_ENET0_MDC__ENET0_MDC,
	MX6_PAD_ENET0_MDIO__ENET0_MDIO,
	MX6_PAD_ENET0_RX_EN__GPIO_4_2,	/* COL/CRS_DV/MODE2 */
	MX6_PAD_ENET0_RXD0__GPIO_4_3,	/* RXD0/MODE0 */
	MX6_PAD_ENET0_RXD1__GPIO_4_4,	/* RXD1/MODE1 */
	MX6_PAD_ENET0_TX_CLK__GPIO_4_5,	/* nINT/TX_ER/TXD4 */
	MX6_PAD_ENET0_TX_EN__ENET0_TX_EN,
	MX6_PAD_ENET0_TXD0__ENET0_TXD0,
	MX6_PAD_ENET0_TXD1__ENET0_TXD1,
	MX6_PAD_ENET_CLK__CLKCTRL_ENET,

	/* MMC pads */
	MX6_PAD_SSP0_DATA0__SSP0_D0,
	MX6_PAD_SSP0_DATA1__SSP0_D1,
	MX6_PAD_SSP0_DATA2__SSP0_D2,
	MX6_PAD_SSP0_DATA3__SSP0_D3,
	MX6_PAD_SSP0_CMD__SSP0_CMD,
	MX6_PAD_SSP0_DETECT__SSP0_CARD_DETECT,
	MX6_PAD_SSP0_SCK__SSP0_SCK,

	/* GPMI pads */
	MX6_PAD_GPMI_D00__GPMI_D0,
	MX6_PAD_GPMI_D01__GPMI_D1,
	MX6_PAD_GPMI_D02__GPMI_D2,
	MX6_PAD_GPMI_D03__GPMI_D3,
	MX6_PAD_GPMI_D04__GPMI_D4,
	MX6_PAD_GPMI_D05__GPMI_D5,
	MX6_PAD_GPMI_D06__GPMI_D6,
	MX6_PAD_GPMI_D07__GPMI_D7,
	MX6_PAD_GPMI_CE0N__GPMI_CE0N,
	MX6_PAD_GPMI_RDY0__GPMI_READY0,
	MX6_PAD_GPMI_RDN__GPMI_RDN,
	MX6_PAD_GPMI_WRN__GPMI_WRN,
	MX6_PAD_GPMI_ALE__GPMI_ALE,
	MX6_PAD_GPMI_CLE__GPMI_CLE,
	MX6_PAD_GPMI_RESETN__GPMI_RESETN,

	/* maybe used for EDT-FT5x06 */
	MX6_PAD_SSP0_DATA5__GPIO_2_5,
	MX6_PAD_SSP0_DATA6__GPIO_2_6,
	MX6_PAD_ENET0_RXD2__GPIO_4_9,

	/* unused pads */
	MX6_PAD_GPMI_RDY1__GPIO_0_21,
	MX6_PAD_GPMI_RDY2__GPIO_0_22,
	MX6_PAD_GPMI_RDY3__GPIO_0_23,
	MX6_PAD_GPMI_CE1N__GPIO_0_17,
	MX6_PAD_GPMI_CE2N__GPIO_0_18,
	MX6_PAD_GPMI_CE3N__GPIO_0_19,

	MX6_PAD_SSP0_DATA4__GPIO_2_4,
	MX6_PAD_SSP0_DATA7__GPIO_2_7,

	MX6_PAD_SSP2_SS0__GPIO_2_19,
	MX6_PAD_SSP2_SS1__GPIO_2_20,
	MX6_PAD_SSP2_SS2__GPIO_2_21,
	MX6_PAD_SSP3_SS0__GPIO_2_27,

	MX6_PAD_ENET0_TXD2__GPIO_4_11,
	MX6_PAD_ENET0_TXD3__GPIO_4_12,
	MX6_PAD_ENET0_CRS__GPIO_4_15,
};

static void tx6q_stk5_lcd_init(void)
{
	gpio_direction_output(MX6_PAD_PWM0__GPIO_3_16, 1);
	gpio_direction_output(MX6_PAD_LCD_RESET__GPIO_3_30, 0);
	gpio_direction_output(MX6_PAD_LCD_ENABLE__GPIO_1_31, 0);
}

static void tx6q_stk5_led_on(void)
{
	gpio_direction_output(MX6Q_PAD_EIM_A18__GPIO_2_20, 1);
}

void board_init_ll(void)
{
	mx6_common_spl_init(tx6q_stk5_pads, ARRAY_SIZE(tx6q_stk5_pads));
	tx6q_stk5_lcd_init();
	tx6q_stk5_led_on();
}
